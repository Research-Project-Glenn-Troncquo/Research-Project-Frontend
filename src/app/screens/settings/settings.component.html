<div class="container mx-auto mt-6 p-4">
  <div class="mb-6 mx-auto max-w-3xl">
    <h3 class="text-3xl text-gray-700 font-semibold">Account Settings</h3>
    <p class="text-gray-500 text-lg">
      Change your profile and account settings
    </p>
  </div>

  <div class="bg-white w-auto rounded-sm shadow-md max-w-3xl mx-auto">
    <div *ngIf="user.username" class="p-5">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">General info</h3>
      <div class="flex gap-4 items-center">
        <button
          class="w-24 h-24 rounded-full border-4 cursor-pointer border-white z-10 mb-4 group transition-all ease-out duration-300"
        >
          <input
            class="hidden"
            type="file"
            id="file-upload"
            [(ngModel)]="profilePicture"
            (change)="handleProfilePicture($event)"
            accept="image/x-png,image/gif,image/jpeg"
          />
          <label class="cursor-pointer" for="file-upload">
            <img
              class="w-full h-full rounded-full group-hover:brightness-90"
              [src]="
                user.img_url ? user.img_url : '../../../assets/no-profile.png'
              "
              alt="profile picture of user"
            />
          </label>
        </button>
        <div>
          <p class="font-semibold text-2xl text-gray-700">
            {{ user.name | titlecase }} {{ user.lastname | titlecase }}
          </p>
          <p class="font-semibold text-lg text-gray-400">
            {{ user.username }}
          </p>
        </div>
      </div>

      <form class="">
        <div class="flex gap-4">
          <div class="max-w-sm w-full" [formGroup]="settingsForm">
            <label class="block text-lg font-semibold" for="name"> Name </label>
            <input
              class="border-2 rounded-md w-full box-border p-2 outline-none mb-5"
              id="name"
              type="text"
              formControlName="name"
            />

            <app-input-error
              errorMsg="Please fill in a name"
              [show]="name?.errors?.['required'] && name?.invalid && (name?.dirty || name?.touched) ? true : false"
              errorName="name"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>

            <app-input-error
              errorMsg="Name must be at least 2 characters long"
              [show]="name?.errors?.['minlength'] && name?.invalid && (name?.dirty || name?.touched) ? true : false"
              errorName="name"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>

            <app-input-error
              errorMsg="Name can not contain special characters"
              [show]="name?.errors?.['forbiddenName']&& name?.value.length>1 && name?.invalid && (name?.dirty || name?.touched) ? true : false"
              errorName="name"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>
          </div>

          <div class="max-w-sm w-full" [formGroup]="settingsForm">
            <label class="block text-lg font-semibold" for="lastname">
              Last Name
            </label>
            <input
              class="border-2 rounded-md w-full box-border p-2 outline-none mb-5"
              id="lastname"
              type="text"
              formControlName="lastname"
            />
            <app-input-error
              errorMsg="Please fill in a last name"
              [show]="lastname?.errors?.['required'] && lastname?.invalid && (lastname?.dirty || lastname?.touched) ? true : false"
              errorName="lastname"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>

            <app-input-error
              errorMsg="Last name must be at least 2 characters long"
              [show]="lastname?.errors?.['minlength'] && lastname?.invalid && (lastname?.dirty || lastname?.touched) ? true : false"
              errorName="lastname"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>

            <app-input-error
              errorMsg="Last name can not contain special characters"
              [show]="lastname?.errors?.['forbiddenName']&& lastname?.value.length>1 && lastname?.invalid && (lastname?.dirty || lastname?.touched) ? true : false"
              errorName="lastname"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>
          </div>
        </div>
        <div class="flex gap-4">
          <div class="max-w-sm w-full" [formGroup]="settingsForm">
            <label class="block text-lg font-semibold" for="username">
              Username
            </label>
            <input
              class="border-2 rounded-md w-full box-border p-2 outline-none mb-5"
              id="username"
              type="text"
              formControlName="username"
            />
            <app-input-error
              errorMsg="Please fill in a username"
              [show]="username?.errors?.['required'] && username?.invalid && (username?.dirty || username?.touched) ? true : false"
              errorName="username"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>

            <app-input-error
              errorMsg="Username must be at least 2 characters long"
              [show]="username?.errors?.['minlength'] && username?.invalid && (username?.dirty || username?.touched) ? true : false"
              errorName="username"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>

            <app-input-error
              errorMsg="Last name can not contain special characters"
              [show]="username?.errors?.['forbiddenName']&& username?.value.length>1 && username?.invalid && (username?.dirty || username?.touched) ? true : false"
              errorName="username"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>
          </div>

          <div class="max-w-sm w-full" [formGroup]="settingsForm">
            <label class="block text-lg font-semibold" for="email-input">
              Email
            </label>
            <input
              class="border-2 rounded-md w-full box-border p-2 outline-none mb-5"
              id="email-input"
              type="text"
              formControlName="email"
            />
            <app-input-error
              errorMsg="Please fill in an email"
              [show]="email?.errors?.['required'] && email?.invalid && (email?.dirty || email?.touched) ? true : false"
              errorName="email"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>

            <app-input-error
              errorMsg="Email is not valid"
              [show]="email?.errors?.['email'] && email?.invalid && (email?.dirty || email?.touched) ? true : false"
              errorName="email"
              (emitClickEvent)="handleErrorEmit($event)"
            ></app-input-error>
          </div>
        </div>

        <app-button name="Save"></app-button>
      </form>
    </div>
  </div>
</div>
